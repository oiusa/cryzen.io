import{a as d}from"./ResourceLoader-C0oah4Xo.js";import{ae as c}from"./index-ltdjbB5e.js";const s=c();class g{priority=d.RENDERING;gameWorld;onRemove;constructor(e){this.gameWorld=e;const t=this.setSize.bind(this);window.addEventListener("orientationchange",t),window.addEventListener("resize",t);const{off:n}=s.addListener(({general:{resolution:r}})=>{e.threeScene.renderer.setPixelRatio(r)});this.onRemove=()=>{window.removeEventListener("orientationchange",t),window.removeEventListener("resize",t);const r=e.threeScene.renderer;r.clear(),r.dispose(),n()},this.setSize()}setSize(){const e=this.gameWorld.threeScene,t=this.gameWorld.threeScene.renderer.domElement;let n=t.clientWidth/t.clientHeight;const r=e.camera;r.isOrthographicCamera?(r.left=n/-2,r.right=n/2,r.top=1/2,r.bottom=1/-2):r.aspect=n,r.updateProjectionMatrix();const i=Math.min(window.devicePixelRatio,2),{width:o,height:a}=t.getBoundingClientRect();e.renderer.setSize(Math.round(o*i),Math.round(a*i),!1),e.renderer.setPixelRatio(s.settings.general.resolution),this.gameWorld.needsUpdate!==void 0&&(this.gameWorld.needsUpdate=!0)}execute(){if(this.gameWorld.needsUpdate===!1)return;this.gameWorld.needsUpdate&&(this.gameWorld.needsUpdate=!1);const e=this.gameWorld.threeScene,t=e.renderer;t.autoClear===!1&&t.clear(),t.render(e.scene,e.camera),e.sceneWithShadows&&t.render(e.sceneWithShadows,e.camera)}}export{g as L};
